<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Iframes</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="mobile-web-app-capable" name="mobile-web-app-capable" content="yes"><meta data-n-head="ssr" data-hid="apple-mobile-web-app-title" name="apple-mobile-web-app-title" content="Rosem Space"><meta data-n-head="ssr" data-hid="author" name="author" content="Roman Shevchenko"><meta data-n-head="ssr" data-hid="theme-color" name="theme-color" content="#fbf"><meta data-n-head="ssr" data-hid="og:type" name="og:type" property="og:type" content="website"><meta data-n-head="ssr" data-hid="og:title" name="og:title" property="og:title" content="Rosem Space"><meta data-n-head="ssr" data-hid="og:site_name" name="og:site_name" property="og:site_name" content="Rosem Space"><meta data-n-head="ssr" data-hid="description" name="description" content="Iframes"><meta data-n-head="ssr" data-hid="og:description" name="og:description" property="og:description" content="Iframes"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="preconnect" href="https://fonts.googleapis.com" crossorigin="anonymous"><link data-n-head="ssr" rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link data-n-head="ssr" rel="manifest" href="/assets/manifest.9e6b726f.json"><link data-n-head="ssr" rel="shortcut icon" href="/assets/icons/icon_64.6d9a16.png"><link data-n-head="ssr" rel="apple-touch-icon" href="/assets/icons/icon_512.6d9a16.png" sizes="512x512"><link rel="preload" href="/assets/runtime.da0a480.js" as="script"><link rel="preload" href="/assets/commons/app.86bd825.js" as="script"><link rel="preload" href="/assets/vendors~app.2e51247.css" as="style"><link rel="preload" href="/assets/vendors~app.98a0c5a.js" as="script"><link rel="preload" href="/assets/app.746d0ac.css" as="style"><link rel="preload" href="/assets/app.892da53.js" as="script"><link rel="preload" href="/assets/pages/experiments/1.56fa45b.css" as="style"><link rel="preload" href="/assets/pages/experiments/1.32c2d9f.js" as="script"><link rel="stylesheet" href="/assets/vendors~app.2e51247.css"><link rel="stylesheet" href="/assets/app.746d0ac.css"><link rel="stylesheet" href="/assets/pages/experiments/1.56fa45b.css"><link rel="preload" href="/assets/static/1594334704/experiments/1/payload.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div data-v-15e67413><nav data-v-4bef6e9a data-v-15e67413><a href="/" class="link-active" data-v-4bef6e9a>Home</a> <a href="/authors/roshe" data-v-4bef6e9a>Author</a></nav> <main class="container" data-v-15e67413><div class="bg" data-v-15e67413><img src="/assets/img/bg.c3d4934.jpg" alt="Background image" data-v-15e67413></div> <div class="container" data-v-3e6219ff data-v-15e67413><h1 class="text-3xl font-bold mb-4" data-v-3e6219ff>Experiment 1</h1> <div class="flex mb-4" data-v-3e6219ff><div class="w-full" data-v-3e6219ff><h2 class="text-xl font-bold" data-v-3e6219ff>Description</h2> <p data-v-3e6219ff>
        When the DOM mutation method such as <code data-v-3e6219ff>appendChild</code> or
        <code data-v-3e6219ff>insertBefore</code> is called add a red border for all inserted
        <code data-v-3e6219ff>DIV</code> elements including those in currently inserting
        <code data-v-3e6219ff>IFRAME</code> elements.
      </p> <div class="flex mt-4" data-v-3e6219ff><button class="px-4 py-2 rounded text-white bg-red-400" data-v-3e6219ff>
          Insert 3 new nested DIVs
        </button> <button class="ml-4 px-4 py-2 rounded text-white bg-red-400" data-v-3e6219ff>
          Insert new IFRAME
        </button> <button class="ml-4 px-4 py-2 rounded text-white bg-red-400" data-v-3e6219ff>
          Insert new 3rd-party IFRAME
        </button></div> <div data-v-3e6219ff></div></div> <div class="ml-4" data-v-3e6219ff><h2 class="text-xl font-bold" data-v-3e6219ff>Solution</h2> <p data-v-3e6219ff>
        For 3rd-party <code data-v-3e6219ff>IFRAME</code>s we can configure a proxy server or
        fetch its content via <code data-v-3e6219ff>AJAX</code>, add <code data-v-3e6219ff>BASE</code> tag and
        insert the final <code data-v-3e6219ff>HTML</code> in <code data-v-3e6219ff>srcdoc</code> attribute
        (or encoded <code data-v-3e6219ff>HTML</code> in <code data-v-3e6219ff>src</code> attribute).
      </p> <div class="nuxt-content" data-v-3e6219ff data-v-3e6219ff><div class="nuxt-content-highlight" data-v-3e6219ff data-v-3e6219ff><pre class="language-js line-numbers" data-v-3e6219ff data-v-3e6219ff><code data-v-3e6219ff data-v-3e6219ff><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token keyword" data-v-3e6219ff data-v-3e6219ff>function</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token parameter" data-v-3e6219ff data-v-3e6219ff>globalThis<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> <span class="token keyword nil" data-v-3e6219ff data-v-3e6219ff>undefined</span></span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
  <span class="token string" data-v-3e6219ff data-v-3e6219ff>'use strict'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>

  patchNativeMethods<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token constant" data-v-3e6219ff data-v-3e6219ff>NATIVE_PREFIX</span> <span class="token operator" data-v-3e6219ff data-v-3e6219ff>=</span> <span class="token string" data-v-3e6219ff data-v-3e6219ff>'__native_'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>

  <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>function</span> <span class="token function" data-v-3e6219ff data-v-3e6219ff>patchNativeMethods</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token parameter" data-v-3e6219ff data-v-3e6219ff>ownerWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> patchMap<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> preCallback</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
    <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>for</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token keyword" data-v-3e6219ff data-v-3e6219ff>var</span> targetClass <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>in</span> patchMap<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
      <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// Do not iterate over a prototype</span>
      <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>if</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token operator" data-v-3e6219ff data-v-3e6219ff>!</span>patchMap<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>hasOwnProperty</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>targetClass<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
        <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>break</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
      <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>

      <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>var</span> target <span class="token operator" data-v-3e6219ff data-v-3e6219ff>=</span> ownerWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>[</span>targetClass<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>]</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>

      patchMap<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>[</span>targetClass<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>]</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>forEach</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token keyword" data-v-3e6219ff data-v-3e6219ff>function</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token parameter" data-v-3e6219ff data-v-3e6219ff>methodName</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
        <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>var</span> nativeMethod <span class="token operator" data-v-3e6219ff data-v-3e6219ff>=</span> target<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token property-access" data-v-3e6219ff data-v-3e6219ff>prototype</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>[</span>methodName<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>]</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>

        <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// Save the native method to do not lose it</span>
        <span class="token known-class-name class-name" data-v-3e6219ff data-v-3e6219ff>Object</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>defineProperty</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>
          target<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token property-access" data-v-3e6219ff data-v-3e6219ff>prototype</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
          patchNativeMethods<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token constant" data-v-3e6219ff data-v-3e6219ff>NATIVE_PREFIX</span> <span class="token operator" data-v-3e6219ff data-v-3e6219ff>+</span> methodName<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
          <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
            value<span class="token operator" data-v-3e6219ff data-v-3e6219ff>:</span> nativeMethod<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
            configurable<span class="token operator" data-v-3e6219ff data-v-3e6219ff>:</span> <span class="token boolean" data-v-3e6219ff data-v-3e6219ff>true</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
            writable<span class="token operator" data-v-3e6219ff data-v-3e6219ff>:</span> <span class="token boolean" data-v-3e6219ff data-v-3e6219ff>true</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
            enumerable<span class="token operator" data-v-3e6219ff data-v-3e6219ff>:</span> <span class="token boolean" data-v-3e6219ff data-v-3e6219ff>false</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
          <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>
        <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
        <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// Redefine the native method by the custom one</span>
        target<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token property-access" data-v-3e6219ff data-v-3e6219ff>prototype</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>[</span>methodName<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>]</span> <span class="token operator" data-v-3e6219ff data-v-3e6219ff>=</span> <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>function</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
          <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// Call the custom pre-callback</span>
          preCallback<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>apply</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token keyword" data-v-3e6219ff data-v-3e6219ff>this</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> arguments<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
          <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// Call the native method</span>
          nativeMethod<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>apply</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token keyword" data-v-3e6219ff data-v-3e6219ff>this</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> arguments<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
        <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
      <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
    <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>
  <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>

  <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>function</span> <span class="token function" data-v-3e6219ff data-v-3e6219ff>patchElements</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token parameter" data-v-3e6219ff data-v-3e6219ff>ownerWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> element<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> patchCallback<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> onIframeMounted</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
    <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// Ignore non-elements</span>
    <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>if</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token operator" data-v-3e6219ff data-v-3e6219ff>!</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>element <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>instanceof</span> <span class="token class-name" data-v-3e6219ff data-v-3e6219ff>ownerWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span>Element</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
      <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>return</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
    <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>

    <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>var</span> iframeCollectionLength <span class="token operator" data-v-3e6219ff data-v-3e6219ff>=</span> element<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token property-access" data-v-3e6219ff data-v-3e6219ff>tagName</span> <span class="token operator" data-v-3e6219ff data-v-3e6219ff>===</span> <span class="token string" data-v-3e6219ff data-v-3e6219ff>'IFRAME'</span> <span class="token operator" data-v-3e6219ff data-v-3e6219ff>?</span> <span class="token number" data-v-3e6219ff data-v-3e6219ff>1</span> <span class="token operator" data-v-3e6219ff data-v-3e6219ff>:</span> <span class="token number" data-v-3e6219ff data-v-3e6219ff>0</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
    <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>var</span> iframeCollection <span class="token operator" data-v-3e6219ff data-v-3e6219ff>=</span> element<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>getElementsByTagName</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token string" data-v-3e6219ff data-v-3e6219ff>'iframe'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>

    iframeCollectionLength <span class="token operator" data-v-3e6219ff data-v-3e6219ff>+=</span> iframeCollection<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token property-access" data-v-3e6219ff data-v-3e6219ff>length</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>

    <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>for</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token keyword" data-v-3e6219ff data-v-3e6219ff>var</span> index <span class="token operator" data-v-3e6219ff data-v-3e6219ff>=</span> <span class="token number" data-v-3e6219ff data-v-3e6219ff>0</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span> index <span class="token operator" data-v-3e6219ff data-v-3e6219ff>&lt;</span> iframeCollectionLength<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span> <span class="token operator" data-v-3e6219ff data-v-3e6219ff>++</span>index<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
      <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// Call as a next microtask when the iframe will be already inserted into</span>
      <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// the DOM to get the iframe's window</span>
      <span class="token known-class-name class-name" data-v-3e6219ff data-v-3e6219ff>Promise</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>resolve</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>then</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token keyword" data-v-3e6219ff data-v-3e6219ff>function</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token parameter" data-v-3e6219ff data-v-3e6219ff>iframeCollectionLength<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> index</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
        <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// Get the last unprocessed iframe window</span>
        <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>var</span> iframeWindow <span class="token operator" data-v-3e6219ff data-v-3e6219ff>=</span> ownerWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token property-access" data-v-3e6219ff data-v-3e6219ff>frames</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>[</span>
          ownerWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token property-access" data-v-3e6219ff data-v-3e6219ff>frames</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token property-access" data-v-3e6219ff data-v-3e6219ff>length</span> <span class="token operator" data-v-3e6219ff data-v-3e6219ff>-</span> iframeCollectionLength <span class="token operator" data-v-3e6219ff data-v-3e6219ff>+</span> index
        <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>]</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>

        <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// The iframe already inserted into the DOM</span>
        <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>if</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>onIframeMounted<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
          <span class="token function" data-v-3e6219ff data-v-3e6219ff>onIframeMounted</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>iframeWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
        <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>

        <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// Patch iframe elements when content will be loaded</span>
        iframeWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>addEventListener</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>
          <span class="token string" data-v-3e6219ff data-v-3e6219ff>'DOMContentLoaded'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
          <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>function</span> <span class="token function" data-v-3e6219ff data-v-3e6219ff>onIframeDOMContentLoaded</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
            <span class="token function" data-v-3e6219ff data-v-3e6219ff>patchElements</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>
              iframeWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
              iframeWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token property-access" data-v-3e6219ff data-v-3e6219ff>document</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token property-access" data-v-3e6219ff data-v-3e6219ff>documentElement</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
              patchCallback<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
              onIframeMounted
            <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
            <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// The event listener should be called only once</span>
            iframeWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>removeEventListener</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>
              <span class="token string" data-v-3e6219ff data-v-3e6219ff>'DOMContentLoaded'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
              onIframeDOMContentLoaded
            <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
          <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>bind</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token keyword" data-v-3e6219ff data-v-3e6219ff>this</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span>
        <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
      <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>bind</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token keyword" data-v-3e6219ff data-v-3e6219ff>this</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> iframeCollectionLength<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> index<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
    <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>

    <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// Patch elements</span>
    <span class="token function" data-v-3e6219ff data-v-3e6219ff>patchCallback</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>element<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
  <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>

  <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>function</span> <span class="token function" data-v-3e6219ff data-v-3e6219ff>patch</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token parameter" data-v-3e6219ff data-v-3e6219ff>ownerWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> methodPatchMap<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> patchCallback</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
    <span class="token function" data-v-3e6219ff data-v-3e6219ff>patchNativeMethods</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>ownerWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> methodPatchMap<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>function</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token parameter" data-v-3e6219ff data-v-3e6219ff>element</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
      <span class="token function" data-v-3e6219ff data-v-3e6219ff>patchElements</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>ownerWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> element<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> patchCallback<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>function</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token parameter" data-v-3e6219ff data-v-3e6219ff>ownerWindow</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
        <span class="token function" data-v-3e6219ff data-v-3e6219ff>patch</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>ownerWindow<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> methodPatchMap<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span> patchCallback<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
      <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
    <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
  <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>

  <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// ------------------------- Patch all div elements -------------------------</span>

  <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>function</span> <span class="token function" data-v-3e6219ff data-v-3e6219ff>patchDivElement</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token parameter" data-v-3e6219ff data-v-3e6219ff>element</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
    element<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>setAttribute</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>
      <span class="token string" data-v-3e6219ff data-v-3e6219ff>'style'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
      <span class="token string" data-v-3e6219ff data-v-3e6219ff>'margin-top: 0.5rem; margin-bottom: 0.5rem; \
        padding-left: 0.5rem; padding-right: 0.5rem; border: solid 1px red;'</span>
    <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
  <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>

  <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>function</span> <span class="token function" data-v-3e6219ff data-v-3e6219ff>patchDivElements</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token parameter" data-v-3e6219ff data-v-3e6219ff>element</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
    <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// Patch the current element</span>
    <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>if</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>element<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token property-access" data-v-3e6219ff data-v-3e6219ff>tagName</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>toLowerCase</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token operator" data-v-3e6219ff data-v-3e6219ff>===</span> <span class="token string" data-v-3e6219ff data-v-3e6219ff>'div'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
      <span class="token function" data-v-3e6219ff data-v-3e6219ff>patchDivElement</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>element<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
    <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>

    <span class="token comment" data-v-3e6219ff data-v-3e6219ff>// Patch nested elements</span>
    <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>var</span> divCollection <span class="token operator" data-v-3e6219ff data-v-3e6219ff>=</span> element<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token method function property-access" data-v-3e6219ff data-v-3e6219ff>getElementsByTagName</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token string" data-v-3e6219ff data-v-3e6219ff>'div'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>

    <span class="token keyword" data-v-3e6219ff data-v-3e6219ff>for</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span><span class="token keyword" data-v-3e6219ff data-v-3e6219ff>var</span> index <span class="token operator" data-v-3e6219ff data-v-3e6219ff>=</span> <span class="token number" data-v-3e6219ff data-v-3e6219ff>0</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span> index <span class="token operator" data-v-3e6219ff data-v-3e6219ff>&lt;</span> divCollection<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>.</span><span class="token property-access" data-v-3e6219ff data-v-3e6219ff>length</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span> <span class="token operator" data-v-3e6219ff data-v-3e6219ff>++</span>index<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
      <span class="token function" data-v-3e6219ff data-v-3e6219ff>patchDivElement</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>divCollection<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>[</span>index<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>]</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
    <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>
  <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span>

  <span class="token function" data-v-3e6219ff data-v-3e6219ff>patch</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>
    globalThis<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
    <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>{</span>
      <span class="token maybe-class-name" data-v-3e6219ff data-v-3e6219ff>Node</span><span class="token operator" data-v-3e6219ff data-v-3e6219ff>:</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>[</span>
        <span class="token string" data-v-3e6219ff data-v-3e6219ff>'appendChild'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
        <span class="token string" data-v-3e6219ff data-v-3e6219ff>'insertBefore'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
        <span class="token string" data-v-3e6219ff data-v-3e6219ff>'replaceChild'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
      <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>]</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
      <span class="token maybe-class-name" data-v-3e6219ff data-v-3e6219ff>Element</span><span class="token operator" data-v-3e6219ff data-v-3e6219ff>:</span> <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>[</span>
        <span class="token string" data-v-3e6219ff data-v-3e6219ff>'insertAdjacentElement'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
        <span class="token string" data-v-3e6219ff data-v-3e6219ff>'replaceWith'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
        <span class="token string" data-v-3e6219ff data-v-3e6219ff>'append'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
        <span class="token string" data-v-3e6219ff data-v-3e6219ff>'prepend'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
        <span class="token string" data-v-3e6219ff data-v-3e6219ff>'after'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
        <span class="token string" data-v-3e6219ff data-v-3e6219ff>'before'</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
      <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>]</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
    <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>,</span>
    patchDivElements
  <span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>}</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>(</span>self<span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>)</span><span class="token punctuation" data-v-3e6219ff data-v-3e6219ff>;</span>
</code></pre></div></div></div></div></div></main> <footer data-v-6b3e79d3 data-v-15e67413><a href="/legal/privacy" data-v-6b3e79d3>Privacy Policy</a></footer></div></div></div><script>window.__NUXT__={staticAssetsBase:"/assets/static/1594334704",layout:"default",error:null,serverRendered:!0,routePath:"/experiments/1",config:{baseURL:"http://localhost:3000",locale:"en"}}</script><script src="/assets/runtime.da0a480.js" defer></script><script src="/assets/pages/experiments/1.32c2d9f.js" defer></script><script src="/assets/commons/app.86bd825.js" defer></script><script src="/assets/vendors~app.98a0c5a.js" defer></script><script src="/assets/app.892da53.js" defer></script>
  </body>
</html>
